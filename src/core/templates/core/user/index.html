{% extends 'core/user/layout.html' %}
{% load static %}

{% block title %} {% if seo_block %}{{ seo_block.title_seo }}{% endif %} {% endblock %}
{% block keywords %} {% if seo_block %}{{ seo_block.keywords_seo }}{% endif %} {% endblock %}
{% block description %} {% if seo_block %}{{ seo_block.description_seo }}{% endif %} {% endblock %}
{% block og_url %} {% if seo_block %}{{ seo_block.slug }}{% endif %} {% endblock %}

{% block style-body %}
{% if background and background.image_banner %}
  style="background: url('{{ background.image_banner.url }}') no-repeat center center fixed"
{% elif background and background.color %}
  style="background-color: {{ background.color }}"
{% endif %}
{% endblock %}


{% block content %}
<!-- Карусель -->
    {% if home_slides %}
  {% with speed=home_slides.0.speed_banner|default:5 %}
  <div id="myCarousel" class="carousel slide mx-auto"
       data-bs-ride="carousel"
       data-bs-interval="{{ speed }}000"
       style="width: 50%;">

    <div class="carousel-indicators">
      {% for s in home_slides %}
        <button type="button" data-bs-target="#myCarousel" data-bs-slide-to="{{ forloop.counter0 }}"
                class="{% if forloop.first %}active{% endif %}" aria-current="{% if forloop.first %}true{% else %}false{% endif %}"></button>
      {% endfor %}
    </div>

<div class="carousel-inner">
  {% for s in home_slides %}
    <div class="carousel-item {% if forloop.first %}active{% endif %}">
      {% if s.gallery_banner and s.gallery_banner.image_set.first %}
        <img src="{{ s.gallery_banner.image_set.first.image.url }}" alt="картинка" style="width:1000px; height:400px; object-fit:cover;">
      {% else %}
        <img src="{% static 'img/no-image.png' %}" alt="нет картинки">
      {% endif %}

      {% if s.text_banner %}
        <div class="carousel-caption d-none d-md-block">
          <h5>{{ s.text_banner }}</h5>
        </div>
      {% endif %}

      {% if s.url_banner %}
        <a class="stretched-link" href="{{ s.url_banner }}" target="_blank"></a>
      {% endif %}
    </div>
  {% endfor %}
</div>


    <button class="carousel-control-prev" type="button" data-bs-target="#myCarousel" data-bs-slide="prev">
      <span class="carousel-control-prev-icon" aria-hidden="true"></span>
      <span class="visually-hidden">Previous</span>
    </button>
    <button class="carousel-control-next" type="button" data-bs-target="#myCarousel" data-bs-slide="next">
      <span class="carousel-control-next-icon" aria-hidden="true"></span>
      <span class="visually-hidden">Next</span>
    </button>
  </div>
  {% endwith %}
{% endif %}



<!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

        <!-- Блок "Смотрите сегодня" -->
    <div class="container py-4 text-black bg-white">
        <h2 class="text-center mb-4">Смотрите сегодня</h2>
        <div class="row g-4">
            {% for film in today_films %}
            <div class="col-6 col-md-3">
                <div class="movie-card">
                    <a href="{% url 'core:film_page' film.pk %}"><img src="{{ film.main_image.url }}" alt="{{ film.title }}"></a>
                    <h5 class="mt-2"><a href="{% url 'core:film_page' film.pk %}">{{ film.title }}</a></h5>
                    <button class="btn btn-buy">Купить билет</button>
                </div>
            </div>
            {% endfor %}
        </div>

        <!-- Блок "Смотрите скоро" -->
        <h2 class="text-center mt-5 mb-4">Смотрите скоро</h2>
        <div class="row g-4">
            {% for film in soon_films %}
            <div class="col-6 col-md-3">
                <div class="movie-card">
                    <a href="{% url 'core:film_page' film.pk %}"><img src="{{ film.main_image.url }}" alt="{{ film.title }}"></a>
                    <h5 class="mt-2"><a href="{% url 'core:film_page' film.pk %}">{{ film.title }}</a></h5>
                    <button class="btn btn-buy">Купить билет</button>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>

    <div class="container text-center py-4 text-black bg-white">
        <h2>Новости и Акции</h2>

      {% if news_slides %}
  <div id="carouselExample" class="carousel slide" data-bs-ride="carousel">
    <div class="carousel-inner">
      {% for banner in news_slides %}
        {% with img=banner.gallery_banner.image_set.first %}
          {% if img %}
            <div class="carousel-item {% if forloop.first %}active{% endif %}">
              <img src="{{ img.image.url }}"
                   alt="Новость {{ forloop.counter }}"
                   style="width:1000px; height:500px; object-fit:cover;">
            </div>
          {% endif %}
        {% endwith %}
      {% endfor %}
    </div>
    <button class="carousel-control-prev" type="button" data-bs-target="#carouselExample" data-bs-slide="prev">
      <span class="carousel-control-prev-icon" aria-hidden="true"></span>
    </button>
    <button class="carousel-control-next" type="button" data-bs-target="#carouselExample" data-bs-slide="next">
      <span class="carousel-control-next-icon" aria-hidden="true"></span>
    </button>
  </div>
{% endif %}

      <!-- Контекстная реклама -->
        <div class="index-banner-low">
            <div class="ad-box ">
                <img src="https://picsum.photos/1200/500?random=1" alt="Контекстная реклама">
            </div>
        </div>

      <!-- SEO текст -->
        <div class="seo-text">
            <p>{{ main_page.seo_text }}</p>
        </div>
    </div>

{% endblock %}