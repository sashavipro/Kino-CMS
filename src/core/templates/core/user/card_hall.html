{% extends 'core/user/layout.html' %}

{% block title %}{% if seo_block %}{{ seo_block.title_seo }}{% else %}Hall {{ hall.number_hall }} - {{ cinema.name }}{% endif %}{% endblock %}
{% block keywords %}{% if seo_block %}{{ seo_block.keywords_seo }}{% endif %}{% endblock %}
{% block description %}{% if seo_block %}{{ seo_block.description_seo }}{% endif %}{% endblock %}
{% block og_url %}{% if seo_block %}{{ request.build_absolute_uri }}{% endif %}{% endblock %}

{% block cssstyle %}
<style>
    .col-auto img{
        max-height: 60px;
        max-width: 60px;
    }
</style>
{% endblock %}

{% block content %}
<div class="container-fluid">
    <!-- Баннер -->
    <div class="text-center">
        {% if hall.banner_image %}
        <img src="{{ hall.banner_image.url }}" alt="Баннер {{ hall.number_hall }}" style="width:1000px; height:500px; object-fit:cover;">
        {% else %}
        <img src="https://picsum.photos/1200/400?random=1" alt="">
        {% endif %}
    </div>
    <div class="row">
        <!-- Левая колонка -->
        <aside class="col-3 p-3">
            <div class="mb-4">
                <div class="ad-block">
                    <img src="https://picsum.photos/1200/500?random=1" alt="">
                </div>
            </div>
            <div>
                <h4 class="text-black">Кинотеатр <a href="{% url 'core:cinema_card' cinema.pk %}">{{ cinema.name }}</a></h4>
                <h4 class="text-black">Все залы ({{ halls|length }}):</h4>
                <ul class="list-unstyled">
                    {% for h in halls %}
                    <li><a href="{% url 'core:card_hall' h.pk %}">{{ h.number_hall }}</a></li>
                    {% endfor %}
                </ul>
            </div>
            <div>
                <h4 class="text-black">Смотрите сегодня</h4>
                <ul class="list-unstyled">
                    <li><a href="#">Сеанс 1</a></li>
                    <li><a href="#">Сеанс 2</a></li>
                    <li><a href="#">Сеанс 3</a></li>
                </ul>
            </div>
            <div class="mb-2">
                <a href="{% url 'core:schedule' %}"><button class="btn btn-secondary">Расписание сеансов</button></a>
            </div>
        </aside>

        <!-- Правая колонка (каталог фильмов) -->
        <main class="col-9 p-4">
            <div class="container mt-4">
                <h1 class="text-center text-black mb-4">{{ hall.number_hall }}</h1>
                <div class="row">
                    <div class="col text-black">
                        <p>{{ hall.description|linebreaks }}</p>
                    </div>
                </div>
                <h1 class="text-center text-black mb-4">Карта зала</h1>
                <div class="row text-black">
                    {% if hall.scheme_image %}
                    <img src="{{ hall.scheme_image.url }}" alt="Схема зала {{ hall.number_hall }}">
                    {% else %}
                    <p class="text-center">Схема зала не загружена.</p>
                    {% endif %}
                </div>

                <!-- галерея слайдов -->
                  {% if hall.gallery and hall.gallery.image_set.all %}
                  <h4 class="text-black text-center">Фотогалерея</h4>
                  <div id="carouselExample" class="carousel slide" data-bs-ride="carousel">
                    <div class="carousel-indicators">
                        <!-- ИСПРАВЛЕНИЕ №2: Правильный путь к изображениям для цикла -->
                        {% for slide in hall.gallery.image_set.all %}
                            <button type="button" data-bs-target="#carouselExample" data-bs-slide-to="{{ forloop.counter0 }}" class="{% if forloop.first %}active{% endif %}" aria-current="true"></button>
                        {% endfor %}
                    </div>
                    <div class="carousel-inner">
                      {% for slide in hall.gallery.image_set.all %}
                        <div class="carousel-item {% if forloop.first %}active{% endif %}">
                          <img src="{{ slide.image.url }}" class="d-block w-100" alt="{{ hall.number_hall }} - Фото {{ forloop.counter }}" style="width:1000px; height:500px; object-fit:cover;">
                        </div>
                      {% endfor %}
                    </div>
                    <button class="carousel-control-prev" type="button" data-bs-target="#carouselExample" data-bs-slide="prev">
                      <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    </button>
                    <button class="carousel-control-next" type="button" data-bs-target="#carouselExample" data-bs-slide="next">
                      <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    </button>
                  </div>

                {% endif %}

            </div>



        </main>
    </div>
</div>

<!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
{% endblock %}

